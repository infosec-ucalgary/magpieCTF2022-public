FROM nsjailcontainer

ARG USERNAME=magpie
RUN useradd -m $USERNAME
RUN chmod a-w /home/$USERNAME

COPY ./app/biometric_authenticator /root/biometric_authenticator
COPY ./app/flag.txt /home/magpie/flag.txt

RUN chmod o+x /root/biometric_authenticator

EXPOSE 3609

CMD ["/bin/nsjail",                 	\
        "-Ml",                      	\
        "--hostname", "host",       	\
        "--port", "3609",           	\
        "--user", "1001",           	\
        "--group", "1001",         	\
        "--chroot", "/",            	\
        "-E", "TERM=xterm",         	\
        "--cwd", "/home/magpie",    	\
        "--",                       	\
        "/root/biometric_authenticator"	\
    ]
