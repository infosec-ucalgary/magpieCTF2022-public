# biometric-heap
### Category: Binary Exploitation
### Author: Inga 

## Description
This biometric authentication program is a state of the art security modulator which will allow new and current employees to work from home with remote access. The program has already been patented and will soon receive approval to be the main form of authentication at the company. Lucky for us, a company mole by the name of Vex was able to leak the raw binary. He also told us that the program is currently being tested at the given IP and port. Can you find any vulnerabilities we could use to break the security in their authentication program?

## Hints
1. Use after free
2. Difference between strcmp and strncmp

## Solution
Biometric authentication program that was still under development by the company's interns. The program is a terminal like application that has a handful of commands available and will loop until the character "q" is given. The goal of this challenge to is exploit the use after free of the "auth" struct. This struct can be freed and then overwritten with the "strdup" function which is a wrapper for malloc. The function will give you a pointer to the start of the "auth" struct which can be overwritten. After overwriting the password and the function pointer to the pointer of "employee\_shell", the "login" command has to be given and the password supplied has to be your overwrite concactenated with the address of employee\_shell. The jump to the employee\_shell function will spawn a shell to cat the flag. 

1. Identify that the auth struct can be freed but the same pointer is still being used in multiple places in the program.
2. Authenticate as a user using "auth" command.
3. Free the user using the "reset" command.
4. Overwrite the auth struct with the "service" command.
5. The overwrite should be 14 bytes of padding + the address of "employee\_shell".
6. Enter login loop with "login" command.
7. Supply password for user as 8 bytes of the same padding used earlier + address of "employee\_shell".
8. Run "cat flag" command. 

For more details, please see the script in the solve folder.

## Flag
magpie{[]v3rwhel|\/|ed\_1ntern_()v3rfl0w}
