FROM nsjailcontainer

ARG USERNAME=magpie
RUN useradd -m $USERNAME
RUN chmod a-w /home/$USERNAME

COPY available_flags.txt /home/magpie/available_flags.txt
COPY flag.txt /home/magpie/flag.txt
COPY search_source /home/magpie/search_source

RUN chmod o+x /home/magpie/search_source

EXPOSE 1946

CMD ["/bin/nsjail",			\
        "-Ml",				\
        "--hostname", "host",		\
        "--port", "1946",		\
        "--user", "1001",		\
        "--group", "1001",		\
        "--chroot", "/",		\
        "-E", "TERM=xterm",		\
        "--cwd", "/home/magpie",	\
        "--",				\
        "/home/magpie/search_source"		\
    ]