import sys
import reedsolo

reedsolo.init_tables(0x11d)

qr_bytes = '''
01000001
10010110
11010110
00010110
01110111
00000110
10010110
01010111
10110110
????????
????????
????????
????????
????????
????????
????????
????????

01000011
????????
00010101
????????
10111110
????????
01010001
????????
11111000
01011000
????????
????????
????????
10100110
????????
????????
00001101
????1011
'''.split()

qr_bytes_2 = '''
????????
????????
????????
????????
????????
????????
????????
????????
00100111
11010000
11101100
00010001
11101100
00010001
11101100
00010001
11101100

0000????
????????
????????
????????
01101000
????????
01100000
????????
10011011
10100000
????????
10110100
00101000
????????
????????
01111111
????????
01001110
'''.split()

part1 = bytearray()
erasures = []
for i, bits in enumerate(qr_bytes):
    if '?' in bits:
        erasures.append(i)
        part1.append(0)
    else:
        part1.append(int(bits, 2))

mes, ecc = reedsolo.rs_correct_msg(part1, 18, erase_pos=erasures)
for c in mes:
    print('{:08b}'.format(c))

part2 = bytearray()
erasures2 = []
for j, bits2 in enumerate(qr_bytes_2):
    if '?' in bits2:
        erasures2.append(j)
        part2.append(0)
    else:
        part2.append(int(bits2, 2))

mes2, ecc2 = reedsolo.rs_correct_msg(part2, 18, erase_pos=erasures2)
for c2 in mes2:
    print('{:08b}'.format(c2))
